KISSY.add('kg/calendar-deprecated/2.0.0/index',["./lib/base","./lib/date","./lib/page","./lib/time"],function(S ,require, exports, module) {var e=require("./lib/base"),i=require("./lib/date");e.Date=i,require("./lib/page"),require("./lib/time"),module.exports=e;});KISSY.add('kg/calendar-deprecated/2.0.0/lib/base',["event","node"],function(S ,require, exports, module) {function t(t,e){this._init(t,e)}var e=require("event"),n=require("node"),a=e.Target,r=S.DOM,i=S.UA,l=n.all;S.augment(t,a,{_init:function(t,e){var a=this,r=l(t);return a.id=a._stamp(r),a._buildParam(e),a.popup?(a.trigger=r,a.con=new n("<div>"),l(document.body).append(a.con),a.con.css({top:"0px",position:"absolute",background:"white",visibility:"hidden","z-index":99999999})):a.con=r,a.C_Id=a._stamp(a.con),a.render(),a._buildEvent(),this},render:function(t){var e,a,r,l=this,o=0;t=t||{},l._parseParam(t),l.con.addClass("ks-cal-call ks-clearfix ks-cal-call-multi-"+l.pages),l.ca=l.ca||[];for(var o=0;o<l.ca.length;o++)l.ca[o].detachEvent();l.__shimEl&&(l.__shimEl.remove(),delete l.__shimEl),l.con.empty(),l.ca.length=l.pages;var s=!1,u=!1;for(l.range&&(l.range.start&&(s=!0),l.range.end&&(u=!0)),r=s&&!l.rangeLinkage?[l.range.start.getFullYear(),l.range.start.getMonth()]:[l.year,l.month],o=0;o<l.pages;o++){0===o?(s&&(l._time=S.clone(l.range.start)),e=!0):l.rangeLinkage?(u&&(l._time=S.clone(l.range.end)),e=!1,r=l._computeNextMonth(r)):(u&&(l._time=S.clone(l.range.end)),e=!0,r=u&&o+1==l.pages?[l.range.end.getFullYear(),l.range.end.getMonth()]:l._computeNextMonth(r)),a=l.rangeLinkage?o==l.pages-1:!0;var g=l.ca[o];l.rangeLinkage||!g||g.year==r[0]&&g.month==r[1]||(r=[g.year,g.month]),l.ca[o]=new l.Page({year:r[0],month:r[1],prevArrow:e,nextArrow:a,showTime:l.showTime},l),l.ca[o].render()}return l.popup&&6===i.ie&&(l.__shimEl=new n("<iframe frameBorder='0' style='position: absolute;border: none;width: expression(this.parentNode.offsetWidth-3);top: 0;left: 0;z-index: 0;height: expression(this.parentNode.offsetHeight-3);'></iframe>"),l.con.prepend(l.__shimEl)),this},destroy:function(){for(var t=this,e=0;e<t.ca.length;e++)t.ca[e].detachEvent();S.each(t.EV,function(t){t&&t.target.detach(t.type,t.fn)}),t.con.remove()},_stamp:function(t){return t.attr("id")||t.attr("id",S.guid("K_Calendar")),t.attr("id")},_buildEvent:function(){var t,e,n=this;if(!n.popup)return this;for(S.each(n.EV,function(t){t&&t.target.detach(t.type,t.fn)}),n.EV=n.EV||[],t=n.EV[0]={target:l(document),type:"click"},t.fn=function(t){var e=l(t.target);if(e.attr("id")!==n.C_Id&&(!e.hasClass("ks-next")&&!e.hasClass("ks-prev")||"A"!==e[0].tagName)&&e.attr("id")!=n.id&&"hidden"!=n.con.css("visibility")&&(!n.con.contains(e)||"option"!==e[0].nodeName.toLowerCase()&&"select"!==e[0].nodeName.toLowerCase())){var a=function(t,e){return t[0]>e[0].x&&t[0]<e[1].x&&t[1]>e[0].y&&t[1]<e[1].y};a([t.pageX,t.pageY],[{x:n.con.offset().left,y:n.con.offset().top},{x:n.con.offset().left+n.con.width(),y:n.con.offset().top+n.con.height()}])||n.hide()}},t.target.on(t.type,t.fn),e=0;e<n.triggerType.length;e++)t=n.EV[e+1]={target:l("#"+n.id),type:n.triggerType[e],fn:function(t){t.target=l(t.target),t.preventDefault();var e=n.triggerType;S.inArray("click",e)&&S.inArray("focus",e)?"focus"==t.type&&n.toggle():S.inArray("click",e)&&!S.inArray("focus",e)?"click"==t.type&&n.toggle():!S.inArray("click",e)&&S.inArray("focus",e)?setTimeout(function(){n.toggle()},170):n.toggle()}},t.target.on(t.type,t.fn);return this},__getAlignOffset:function(t,e){var a,i,l,o,s,u=e.charAt(0),g=e.charAt(1);return t?(t=n.one(t),a=t.offset(),i=t.outerWidth(),l=t.outerHeight()):(a={left:r.scrollLeft(),top:r.scrollTop()},i=r.viewportWidth(),l=r.viewportHeight()),o=a.left,s=a.top,"c"===u?s+=l/2:"b"===u&&(s+=l),"c"===g?o+=i/2:"r"===g&&(o+=i),{left:o,top:s}},toggle:function(){var t=this;"hidden"==t.con.css("visibility")?t.show():t.hide()},show:function(){var t=this;t.con.css("visibility","");var e=t.align.points,n=t.align.offset||[0,0],a=t.con.offset(),r=t.__getAlignOffset(t.trigger,e[0]),i=t.__getAlignOffset(t.con,e[1]),l=[i.left-r.left,i.top-r.top],o=a.left-l[0]+n[0],s=a.top-l[1]+n[1];return t.con.css("left",o.toString()+"px"),t.con.css("top",s.toString()+"px"),t.fire("show"),this},hide:function(){var t=this;return t.con.css("visibility","hidden"),t.fire("hide"),this},_buildParam:function(t){function e(e,a){var r=t[a];n[a]=void 0===r||null===r?e:r}var n=this;return(void 0===t||null===t)&&(t={}),S.each({date:new Date,selected:null,startDay:0,pages:1,closable:!1,rangeSelect:!1,minDate:!1,maxDate:!1,multiSelect:!1,multi:null,navigator:!0,popup:!1,showTime:!1,triggerType:["click"],disabled:null,range:null,rangeLinkage:!0,align:{points:["bl","tl"],offset:[0,0]},notLimited:!1},e),this},_parseParam:function(t){var e,n=this;(void 0===t||null===t)&&(t={});for(e in t)n[e]=t[e];if("string"==typeof n.triggerType&&(n.triggerType=[n.triggerType]),n.startDay=n.startDay%7,n.startDay<0&&(n.startDay+=7),n.EV=[],n._handleDate(),n.multiSelect&&(n.rangeSelect=!1,n.range=null,n.selected=null,n.multi))for(var e=0;e<n.multi.length;e++)n.multi[e]instanceof Date&&(n.multi[e]=n._handleDate2String(n.multi[e]));return this},_templetShow:function(t,e){var n,a,r,i,l,o;if(e instanceof Array){for(n="",r=0;r<e.length;r++)n+=arguments.callee(t,e[r]);t=n}else if(a=t.match(/{\$(.*?)}/g),void 0!==e&&null!==a)for(r=0,i=a.length;i>r;r++)o=a[r].replace(/({\$)|}/g,""),l=void 0!==e[o]?e[o]:"",t=t.replace(a[r],l);return t},_handleDate:function(){var t=this,e=t.date;return t.weekday=e.getDay()+1,t.day=e.getDate(),t.month=e.getMonth(),t.year=e.getFullYear(),this},_handleDate2String:function(t){var e=t.getFullYear(),n=t.getMonth(),a=t.getDate();return e+"-"+(n>8?n+1:"0"+(n+1))+"-"+(a>9?a:"0"+a)},_handleString2Date:function(t){var e=t.toString().split("-");if(3==e.length){var n=new Date(parseInt(e[0],10),parseInt(e[1],10)-1,parseInt(e[2],10));if(n instanceof Date&&"Invalid Date"!=n&&!isNaN(n))return n}},_getHeadStr:function(t,e){return t.toString()+"年"+(Number(e)+1).toString()+"月"},_monthAdd:function(){var t=this;return 11==t.month?(t.year++,t.month=0):t.month++,t.date=new Date(t.year.toString()+"/"+(t.month+1).toString()+"/1"),this},_monthMinus:function(){var t=this;return 0===t.month?(t.year--,t.month=11):t.month--,t.date=new Date(t.year.toString()+"/"+(t.month+1).toString()+"/1"),this},_yearAdd:function(){var t=this;return t.year++,t.date=new Date(t.year.toString()+"/"+(t.month+1).toString()+"/1"),this},_yearMinus:function(){var t=this;return t.year--,t.date=new Date(t.year.toString()+"/"+(t.month+1).toString()+"/1"),this},_computeNextMonth:function(t){var e=t[0],n=t[1];return 11==n?(e++,n=0):n++,[e,n]},_handleOffset:function(){for(var t=this,e=["日","一","二","三","四","五","六"],n="<span>{$day}</span>",a=t.startDay,r="",i=[],l=0;7>l;l++)i[l]={day:e[(l+a)%7]};return r=t._templetShow(n,i),{day_html:r}},_handleRange:function(t){var e,n=this;return n.range=n.range||{start:null,end:null},null===n.range.start&&null===n.range.end||null!==n.range.start&&null!==n.range.end?(n.range.start=t,n.range.end=null):null!==n.range.start&&null===n.range.end&&(n.range.end=t,n.range.start.getTime()>n.range.end.getTime()&&(e=n.range.start,n.range.start=n.range.end,n.range.end=e),n.fire("rangeSelect",n.range),n.popup&&n.closable&&n.hide()),this},_handleMultiSelectStart:function(t){var e=this;e.multiStart=t},_handleMultiSelectEnd:function(t){var e=this;if(e.multiStart){for(e.multi=e.multi||[],t<e.multiStart?(e.multiEnd=e.multiStart,e.multiStart=t):e.multiEnd=t,e.minDate&&e.multiStart<e.minDate&&(e.multiStart=new Date(e.minDate.getFullYear(),e.minDate.getMonth(),e.minDate.getDate())),e.maxDate&&e.multiEnd>e.maxDate&&(e.multiEnd=new Date(e.maxDate.getFullYear(),e.maxDate.getMonth(),e.maxDate.getDate()));e.multiStart<=e.multiEnd;){var n=!1;if(e.disabled&&e.disabled.length>0)for(var a=0;a<e.disabled.length;a++){var r=e.disabled[a];if(r.getTime()==e.multiStart.getTime()){n=!0;break}}if(!n){var i=e._handleDate2String(e.multiStart);S.inArray(i,e.multi)?e.multi.splice(S.indexOf(i,e.multi),1):e.multi.push(i),e.multiStart.setDate(e.multiStart.getDate()+1)}}e.multiStart=null,e.render()}},_handleMultiSelect:function(){var t=this;t.multi=t.multi||[],t.multi.sort(function(t,e){return t>e?1:-1});for(var e=0;e<t.multi.length;e++)t.multi[e]=t._handleString2Date(t.multi[e]);t.fire("multiSelect",{multi:t.multi}),t.popup&&t.closable&&t.hide()}}),module.exports=t;});KISSY.add('kg/calendar-deprecated/2.0.0/lib/date',[],function(S ,require, exports, module) {function e(e,t){var a=null;if(t=t||"-",a instanceof Date)return a;if(a=new Date(e),a instanceof Date&&"Invalid Date"!=a&&!isNaN(a))return a;var n=e.toString().split(t);return 3==n.length&&(a=new Date(n[0],parseInt(n[1],10)-1,n[2]),a instanceof Date&&"Invalid Date"!=a&&!isNaN(a))?a:null}var t=function(){var e=/w{1}|d{1,4}|m{1,4}|yy(?:yy)?|([HhMsTt])\1?|[LloSZ]|"[^"]*"|'[^']*'/g,t=/\b(?:[PMCEA][SDP]T|(?:Pacific|Mountain|Central|Eastern|Atlantic) (?:Standard|Daylight|Prevailing) Time|(?:GMT|UTC)(?:[-+]\d{4})?)\b/g,a=/[^-+\dA-Z]/g,n=function(e,t){for(e=String(e),t=t||2;e.length<t;)e="0"+e;return e},d={"default":"ddd mmm dd yyyy HH:MM:ss",shortDate:"m/d/yy",longDate:"mmmm d, yyyy",fullDate:"dddd, mmmm d, yyyy",shortTime:"h:MM TT",longTime:"h:MM:ss TT Z",isoDate:"yyyy-mm-dd",isoTime:"HH:MM:ss",isoDateTime:"yyyy-mm-dd'T'HH:MM:ss",isoUTCDateTime:"UTC:yyyy-mm-dd'T'HH:MM:ss'Z'",localShortDate:"yy年mm月dd日",localShortDateTime:"yy年mm月dd日 hh:MM:ss TT",localLongDate:"yyyy年mm月dd日",localLongDateTime:"yyyy年mm月dd日 hh:MM:ss TT",localFullDate:"yyyy年mm月dd日 w",localFullDateTime:"yyyy年mm月dd日 w hh:MM:ss TT"},y={dayNames:["Sun","Mon","Tue","Wed","Thu","Fri","Sat","Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","星期日","星期一","星期二","星期三","星期四","星期五","星期六"],monthNames:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec","January","February","March","April","May","June","July","August","September","October","November","December"]};return function(r,m,i){if(1!=arguments.length||"[object String]"!=Object.prototype.toString.call(r)||/\d/.test(r)||(m=r,r=void 0),r=r?new Date(r):new Date,isNaN(r))throw SyntaxError("invalid date");m=String(d[m]||m||d["default"]),"UTC:"==m.slice(0,4)&&(m=m.slice(4),i=!0);var o=i?"getUTC":"get",s=r[o+"Date"](),l=r[o+"Day"](),u=r[o+"Month"](),M=r[o+"FullYear"](),T=r[o+"Hours"](),c=r[o+"Minutes"](),h=r[o+"Seconds"](),D=r[o+"Milliseconds"](),g=i?0:r.getTimezoneOffset(),f={d:s,dd:n(s,void 0),ddd:y.dayNames[l],dddd:y.dayNames[l+7],w:y.dayNames[l+14],m:u+1,mm:n(u+1,void 0),mmm:y.monthNames[u],mmmm:y.monthNames[u+12],yy:String(M).slice(2),yyyy:M,h:T%12||12,hh:n(T%12||12,void 0),H:T,HH:n(T,void 0),M:c,MM:n(c,void 0),s:h,ss:n(h,void 0),l:n(D,3),L:n(D>99?Math.round(D/10):D,void 0),t:12>T?"a":"p",tt:12>T?"am":"pm",T:12>T?"A":"P",TT:12>T?"AM":"PM",Z:i?"UTC":(String(r).match(t)||[""]).pop().replace(a,""),o:(g>0?"-":"+")+n(100*Math.floor(Math.abs(g)/60)+Math.abs(g)%60,4),S:["th","st","nd","rd"][s%10>3?0:(s%100-s%10!=10)*s%10]};return m.replace(e,function(e){return e in f?f[e]:e.slice(1,e.length-1)})}}();module.exports={format:function(e,a,n){return t(e,a,n)},parse:function(t,a){return e(t,a)}};});KISSY.add('kg/calendar-deprecated/2.0.0/lib/page',["node","./base"],function(S ,require, exports, module) {var e=require("node"),t=require("./base");S.augment(t,{Page:function(t,a){this.father=a,this.month=Number(t.month),this.year=Number(t.year),this.prevArrow=t.prevArrow,this.nextArrow=t.nextArrow,this.node=null,this.timmer=null,this.id="",this.html=['<div class="ks-cal-box" id="{$id}">','<div class="ks-cal-hd">','<a href="javascript:void(0);" class="ks-prev-year {$prev}"><</a><a href="javascript:void(0);" class="ks-prev-month {$prev}"><</a>','<a href="javascript:void(0);" class="ks-title">{$title}</a>','<a href="javascript:void(0);" class="ks-next-month {$next}">></a><a href="javascript:void(0);" class="ks-next-year {$next}">></a>',"</div>",'<div class="ks-cal-bd">','<div class="ks-whd">',a._handleOffset().day_html,"</div>",'<div class="ks-dbd ks-clearfix">',"{$ds}",'<div style="clear:both;"></div>',"</div>","</div>",'<div class="ks-setime hidden">',"</div>",'<div class="{$notlimited}"><a href="#" class="ks-cal-notLimited {$notlimitedCls}">不限</a></div>','<div class="ks-multi-select {$multiSelect}"><button class="ks-multi-select-btn">确定</button></div>','<div class="ks-cal-ft {$showtime}">','<div class="ks-cal-time">',"时间：00:00 &hearts;","</div>","</div>",'<div class="ks-selectime hidden">',"</div>","</div><!--#ks-cal-box-->"].join(""),this.nav_html=["<p>","月",'<select value="{$the_month}">','<option class="m1" value="1">01</option>','<option class="m2" value="2">02</option>','<option class="m3" value="3">03</option>','<option class="m4" value="4">04</option>','<option class="m5" value="5">05</option>','<option class="m6" value="6">06</option>','<option class="m7" value="7">07</option>','<option class="m8" value="8">08</option>','<option class="m9" value="9">09</option>','<option class="m10" value="10">10</option>','<option class="m11" value="11">11</option>','<option class="m12" value="12">12</option>',"</select>","</p>","<p>","年",'<input type="text" value="{$the_year}" onfocus="this.select()"/>',"</p>","<p>",'<button class="ok">确定</button><button class="cancel">取消</button>',"</p>"].join(""),this.Verify=function(){var e=function(e){return/^\d+$/i.test(e)?(e=Number(e),!(1>e||e>31)):!1},t=function(e){return/^\d+$/i.test(e)?(e=Number(e),!(100>e||e>1e4)):!1},a=function(e){return/^\d+$/i.test(e)?(e=Number(e),!(1>e||e>12)):!1};return{isDay:e,isYear:t,isMonth:a}},this._renderUI=function(){var t,a=this,n={};return a.HTML="",n.prev="",n.next="",n.title="",n.ds="",n.notlimited="",n.notlimitedClass="",a.prevArrow||(n.prev="hidden"),a.nextArrow||(n.next="hidden"),a.father.showTime||(n.showtime="hidden"),a.father.notLimited||(n.notlimited="hidden"),a.father.multiSelect||(n.multiSelect="hidden"),a.father.showTime&&a.father.notLimited&&(n.notlimitedCls="ks-cal-notLimited-showTime"),a.father.notLimited&&!a.father.selected&&(n.notlimitedCls+=" ks-cal-notLimited-selected"),n.id=a.id="ks-cal-"+Math.random().toString().replace(/.\./i,""),n.title=a.father._getHeadStr(a.year,a.month),a.createDS(),n.ds=a.ds,a.father.con.append(a.father._templetShow(a.html,n)),a.node=e.one("#"+a.id),a.father.showTime&&(t=a.node.one(".ks-cal-ft"),a.timmer=new a.father.TimeSelector(t,a.father)),this},this.detachEvent=function(){var e=this;e.EV=e.EV||[],S.each(e.EV,function(e){e&&e.target.detach(e.type,e.fn)})},this._buildEvent=function(){function t(){a.target.on(a.type,a.fn)}var a,n=this,r=e.one("#"+n.id);return n.EV=[],n.father.multiSelect||(a=n.EV[n.EV.length]={target:r.one("div.ks-dbd"),type:"click",fn:function(t){if(t.preventDefault(),"A"==t.target.tagName&&(t.target=e(t.target),!t.target.hasClass("ks-null")&&!t.target.hasClass("ks-disabled"))){var a=new Date(n.year,n.month,Number(t.target.html()));n.father.dt_date=a,n.father.fire("select",{date:a}),n.father.popup&&n.father.closable&&!n.father.showTime&&!n.father.rangeSelect&&n.father.hide(),n.father.rangeSelect&&(n.timmer&&(a.setHours(n.timmer.get("h")),a.setMinutes(n.timmer.get("m")),a.setSeconds(n.timmer.get("s"))),n.father._handleRange(a)),n.father.render({selected:a})}}},t()),a=n.EV[n.EV.length]={target:r.one("a.ks-prev-month"),type:"click",fn:function(e){e.preventDefault(),n.father.rangeLinkage||n._monthMinus(),n.father._monthMinus().render(),n.father.fire("monthChange",{date:new Date(n.father.year+"/"+(n.father.month+1)+"/01")})}},t(),a=n.EV[n.EV.length]={target:r.one("a.ks-next-month"),type:"click",fn:function(e){e.preventDefault(),n.father.rangeLinkage||n._monthAdd(),n.father._monthAdd().render(),n.father.fire("monthChange",{date:new Date(n.father.year+"/"+(n.father.month+1)+"/01")})}},t(),a=n.EV[n.EV.length]={target:r.one("a.ks-prev-year"),type:"click",fn:function(e){e.preventDefault(),n.father.rangeLinkage||n._yearMinus(),n.father._yearMinus().render(),n.father.fire("monthChange",{date:new Date(n.father.year+"/"+(n.father.month+1)+"/01")})}},t(),a=n.EV[n.EV.length]={target:r.one("a.ks-next-year"),type:"click",fn:function(e){e.preventDefault(),n.father.rangeLinkage||n._yearAdd(),n.father._yearAdd().render(),n.father.fire("monthChange",{date:new Date(n.father.year+"/"+(n.father.month+1)+"/01")})}},t(),n.father.navigator&&(a=n.EV[n.EV.length]={target:r.one("a.ks-title"),type:"click",fn:function(t){try{n.timmer.hidePopup(),t.preventDefault()}catch(a){}t.target=e(t.target);var i=r.one(".ks-setime");i.html("");var s=n.father._templetShow(n.nav_html,{the_month:n.month+1,the_year:n.year});i.html(s),i.removeClass("hidden"),r.one("input").on("keydown",function(t){if(t.target=e(t.target),38==t.keyCode&&(t.target.val(Number(t.target.val())+1),t.target[0].select()),40==t.keyCode&&(t.target.val(Number(t.target.val())-1),t.target[0].select()),13==t.keyCode){var a=r.one(".ks-setime").one("select").val(),i=r.one(".ks-setime").one("input").val();if(r.one(".ks-setime").addClass("hidden"),!n.Verify().isYear(i))return;if(!n.Verify().isMonth(a))return;n.father.render({date:new Date(i+"/"+a+"/01")}),n.father.fire("monthChange",{date:new Date(i+"/"+a+"/01")})}})}},t(),a=n.EV[n.EV.length]={target:r.one(".ks-setime"),type:"click",fn:function(t){if(t.preventDefault(),t.target=e(t.target),t.target.hasClass("ok")){var a=r.one(".ks-setime").one("select").val(),i=r.one(".ks-setime").one("input").val();if(r.one(".ks-setime").addClass("hidden"),!n.Verify().isYear(i))return;if(!n.Verify().isMonth(a))return;n.father.render({date:new Date(i+"/"+a+"/01")}),n.father.fire("monthChange",{date:new Date(i+"/"+a+"/01")})}else t.target.hasClass("cancel")&&r.one(".ks-setime").addClass("hidden")}},t()),n.father.notLimited&&(a=n.EV[n.EV.length]={target:r.one(".ks-cal-notLimited"),type:"click",fn:function(e){e.preventDefault(),n.father.range={start:null,end:null},n.father.fire("select",{date:null}),n.father.popup&&n.father.closable&&n.father.hide(),n.father.render({selected:null})}},t()),n.father.multiSelect&&(a=n.EV[n.EV.length]={target:r.one("div.ks-dbd"),type:"mousedown",fn:function(t){if(t.preventDefault(),"A"==t.target.tagName&&(t.target=e(t.target),!t.target.hasClass("ks-null")&&!t.target.hasClass("ks-disabled"))){var a=new Date(n.year,n.month,Number(t.target.html()));n.father._handleMultiSelectStart(a)}}},t(),a=n.EV[n.EV.length]={target:r.one("div.ks-dbd"),type:"mouseup",fn:function(t){if(t.preventDefault(),"A"==t.target.tagName&&(t.target=e(t.target),!t.target.hasClass("ks-null")&&!t.target.hasClass("ks-disabled"))){var a=new Date(n.year,n.month,Number(t.target.html()));n.father._handleMultiSelectEnd(a)}}},t(),a=n.EV[n.EV.length]={target:r.one(".ks-multi-select-btn"),type:"click",fn:function(e){e.preventDefault(),n.father._handleMultiSelect()}},t()),this},this._monthAdd=function(){var e=this;11==e.month?(e.year++,e.month=0):e.month++},this._monthMinus=function(){var e=this;0===e.month?(e.year--,e.month=11):e.month--},this._yearAdd=function(){var e=this;e.year++},this._yearMinus=function(){var e=this;e.year--},this._getNode=function(){var e=this;return e.node},this._getNumOfDays=function(e,t){return 32-new Date(e,t-1,32).getDate()},this._isDisabled=function(e,t){if(e&&e.length>0)for(var a=0;a<e.length;a++){var n=e[a];if(t.getFullYear()==n.getFullYear()&&t.getMonth()==n.getMonth()&&t.getDate()==n.getDate())return!0}return!1},this.isInMulit=function(e,t){if(e&&e.length>0)for(var a=0;a<e.length;a++){var n=e[a].split("-");if(t.getFullYear()==parseInt(n[0],10)&&t.getMonth()==parseInt(n[1],10)-1&&t.getDate()==parseInt(n[2],10))return!0}return!1},this.createDS=function(){for(var e,t=this,a="",n=(7-t.father.startDay+new Date(t.year+"/"+(t.month+1)+"/01").getDay())%7,r=t._getNumOfDays(t.year,t.month+1),i=t.father.selected,s=new Date,e=0;n>e;e++)a+='<a href="javascript:void(0);" class="ks-null">0</a>';for(e=1;r>=e;e++){var h="",l=new Date(t.year,t.month,e);t.father.minDate&&new Date(t.year,t.month,e+1)<=t.father.minDate||t.father.maxDate&&l>t.father.maxDate||t._isDisabled(t.father.disabled,l)?h="ks-disabled":t.father.range&&l>=t.father.range.start&&l<=t.father.range.end?h="ks-range":(i&&i.getFullYear()==t.year&&i.getMonth()==t.month&&i.getDate()==e||t.isInMulit(t.father.multi,l))&&(h="ks-selected"),s.getFullYear()==t.year&&s.getMonth()==t.month&&s.getDate()==e&&(h+=" ks-today"),a+="<a "+(h?'class="'+h+'"':"")+' href="javascript:void(0);">'+e+"</a>"}return t.ds=a,this},this.render=function(){var e=this;return e._renderUI(),e._buildEvent(),this}}}),module.exports=t;});KISSY.add('kg/calendar-deprecated/2.0.0/lib/time',["node","./base"],function(S ,require, exports, module) {var t=require("node"),e=require("./base");module.exports=e,S.augment(e,{TimeSelector:function(e,s){this.father=s,this.fcon=e.parent(".ks-cal-box"),this.popupannel=this.fcon.one(".ks-selectime"),"undefined"==typeof s._time&&(s._time=new Date),this.time=s._time,this.status="s",this.ctime=t('<div class="ks-cal-time">时间：<span class="h">h</span>:<span class="m">m</span>:<span class="s">s</span><!--{{arrow--><div class="cta"><button class="u"></button><button class="d"></button></div><!--arrow}}--></div>'),this.button=t('<button class="ct-ok">确定</button>'),this.h_a=["00","01","02","03","04","05","06","07","08","09","10","11","12","13","14","15","16","17","18","19","20","21","22","23"],this.m_a=["00","10","20","30","40","50"],this.s_a=["00","10","20","30","40","50"],this.parseSubHtml=function(t){for(var e="",s=0;s<t.length;s++)e+='<a href="javascript:void(0);" class="item">'+t[s]+"</a>";return e+='<a href="javascript:void(0);" class="x">x</a>'},this.showPopup=function(t){var e=this;this.popupannel.html(t),this.popupannel.removeClass("hidden");var s=e.status;switch(e.ctime.all("span").removeClass("on"),s){case"h":e.ctime.all(".h").addClass("on");break;case"m":e.ctime.all(".m").addClass("on");break;case"s":e.ctime.all(".s").addClass("on")}},this.hidePopup=function(){this.popupannel.addClass("hidden")},this.render=function(){var t=this,e=t.get("h"),s=t.get("m"),a=t.get("s");return t.father._time=t.time,t.ctime.all(".h").html(e),t.ctime.all(".m").html(s),t.ctime.all(".s").html(a),t},this.set=function(t,e){var s=this;switch(e=Number(e),t){case"h":s.time.setHours(e);break;case"m":s.time.setMinutes(e);break;case"s":s.time.setSeconds(e)}s.render()},this.get=function(t){var e=this,s=e.time;switch(t){case"h":return s.getHours();case"m":return s.getMinutes();case"s":return s.getSeconds()}},this.add=function(){var t=this,e=t.status,s=t.get(e);s++,t.set(e,s)},this.minus=function(){var t=this,e=t.status,s=t.get(e);s--,t.set(e,s)},this._init=function(){var s=this;e.html("").append(s.ctime),e.append(s.button),s.render(),s.popupannel.on("click",function(e){var a=t(e.target);if(a.hasClass("x"))s.hidePopup();else if(a.hasClass("item")){var i=Number(a.html());s.set(s.status,i),s.hidePopup()}}),s.button.on("click",function(){var t="undefined"==typeof s.father.dt_date?s.father.date:s.father.dt_date;t.setHours(s.get("h")),t.setMinutes(s.get("m")),t.setSeconds(s.get("s")),s.father.fire("timeSelect",{date:t}),s.father.popup&&s.father.closable&&s.father.hide()}),s.ctime.on("keyup",function(t){(38==t.keyCode||37==t.keyCode)&&(t.preventDefault(),s.add()),(40==t.keyCode||39==t.keyCode)&&(t.preventDefault(),s.minus())}),s.ctime.one(".u").on("click",function(){s.hidePopup(),s.add()}),s.ctime.one(".d").on("click",function(){s.hidePopup(),s.minus()}),s.ctime.one(".h").on("click",function(){var t=s.parseSubHtml(s.h_a);s.status="h",s.showPopup(t)}),s.ctime.one(".m").on("click",function(){var t=s.parseSubHtml(s.m_a);s.status="m",s.showPopup(t)}),s.ctime.one(".s").on("click",function(){var t=s.parseSubHtml(s.s_a);s.status="s",s.showPopup(t)})},this._init()}});});